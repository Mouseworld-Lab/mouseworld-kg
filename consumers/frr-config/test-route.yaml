
######################
# BEANS
######################

- beans:
  - name: triplesFile
    type: "#class:com.cefriel.util.ChimeraResourceBean"
    properties:
      url: "file://./input/input.ttl"
      serializationFormat: "turtle"
  - name: constructGraph
    type: "#class:com.cefriel.util.ChimeraResourceBean"
    properties:
      url: "file://./files/construct.txt"
      serializationFormat: "txt"
  - name: selectNodeQuery
    type: "#class:com.cefriel.util.ChimeraResourceBean"
    properties:
      url: "file://./files/select-node.txt"
      serializationFormat: "txt"
  - name: loweringMappingTemplate
    type: "#class:com.cefriel.util.ChimeraResourceBean"
    properties:
      url: "file://./files/mappings.vm"
      serializationFormat: "vtl"

######################
# ROUTES
######################

- from:
    id: loadTriples
    uri: "graph:get"
    steps:
      - to:
          uri: "graph://add"
          parameters:
            chimeraResource: "#bean:triplesFile"
      - to:
          uri: "seda:lowering"

- from:
    id: lowering
    uri: "seda:lowering"
    steps:
      - to:
          uri: "mapt://rdf"
          parameters:
            template: "#bean:loweringMappingTemplate"
            query: "#bean:selectNodeQuery"
      - log:
          message: "${body}"

